var _=Object.defineProperty;var p=(a,r,e)=>r in a?_(a,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[r]=e;var t=(a,r,e)=>(p(a,typeof r!="symbol"?r+"":r,e),e);class w extends HTMLElement{constructor(){super();t(this,"_carouselSlides");t(this,"_currentSlideIndex",0);t(this,"_carouselControls");t(this,"_carouselContainer");t(this,"_isTransitioning",!1);t(this,"_isTimerPaused",!1);t(this,"_callback");t(this,"_timer");t(this,"_time");t(this,"_slideDuration",6);t(this,"_swipeThreshold",28);t(this,"_swipeRestraint",200);t(this,"_allowedSwipeTime",2500);t(this,"_swipeCounter");t(this,"_swipeStartX");t(this,"_swipeStartY");t(this,"_swipeStartTime");t(this,"_isMouseDown");t(this,"handleControlClick",e=>{if(this._isTransitioning)return;this._isTimerPaused||(this._isTimerPaused=!0),this._isTransitioning=!0;const i=e.currentTarget,s=this._currentSlideIndex,h=parseInt(i.getAttribute("control-direction"));let n=s+h;n<0?n=this._carouselSlides.length-1:n>this._carouselSlides.length-1&&(n=0),s!==n&&(this._currentSlideIndex=n,this.transitionSlides(s,n,h))});t(this,"transitionSlides",(e,i,s)=>{this._carouselSlides[i].style.transform=`translate3d(${100*s}%, 0, 0)`,this._carouselSlides[i].style.display="flex",this._carouselSlides[i].offsetHeight,this._carouselSlides[e].style.transform=`translate3d(${100*(s*-1)}%, 0, 0)`,this._carouselSlides[i].style.transform="translate3d(0, 0, 0)",this._carouselContainer.style.height=`${this._carouselSlides[i].querySelector("slide-content").scrollHeight}px`,setTimeout(()=>{this._carouselSlides[e].style.display="none",this._isTransitioning=!1},500)});t(this,"nextSlide",()=>{this._isTransitioning=!0;const e=this._currentSlideIndex;let i=e+1;i<0?i=this._carouselSlides.length-1:i>this._carouselSlides.length-1&&(i=0),this._currentSlideIndex=i,this.transitionSlides(e,i,1)});t(this,"callbackLoop",()=>{const e=performance.now(),i=(e-this._time)/1e3;this._time=e,this._timer-=i,this._timer<=0&&!this._isTransitioning&&!this._isTimerPaused&&document.hasFocus()&&(this.nextSlide(),this._timer=this._slideDuration),window.requestAnimationFrame(this.callbackLoop)});t(this,"handleTouchStart",e=>{const i=e.changedTouches[0];this._swipeCounter=0,this._swipeStartX=i.pageX,this._swipeStartY=i.pageY,this._swipeStartTime=performance.now()});t(this,"handleTouchMove",()=>{this._swipeCounter===0&&(this._swipeCounter=this._swipeCounter+1)});t(this,"handleTouchEnd",e=>{if(this._swipeCounter===1){const i=e.changedTouches[0],s=i.pageX-this._swipeStartX,h=i.pageY-this._swipeStartY;if(performance.now()-this._swipeStartTime<=this._allowedSwipeTime){const u=this.calculateSwipeDirection(s,h);if(u&&!this._isTransitioning){this._isTransitioning=!0,this._isTimerPaused||(this._isTimerPaused=!0);let l=1;u==="left-swipe"?l=1:l=-1;const c=this._currentSlideIndex;let o=this._currentSlideIndex+l;o<0?o=this._carouselSlides.length-1:o>this._carouselSlides.length-1&&(o=0),this._currentSlideIndex=o,this.transitionSlides(c,o,l)}}}this._swipeCounter=0});this._carouselSlides=Array.from(this.querySelectorAll("carousel-slide")),this._carouselControls=Array.from(this.querySelectorAll("button.control")),this._carouselContainer=this.querySelector("carousel-container")}connectedCallback(){this._carouselControls.forEach(e=>{e.addEventListener("click",this.handleControlClick)}),this._carouselSlides.length>1&&(this._time=performance.now(),this._callback=this.callbackLoop,this._timer=this._slideDuration,this._callback(),this.addSwipeGestures())}addSwipeGestures(){this.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),this.addEventListener("touchmove",this.handleTouchMove,{passive:!0}),this.addEventListener("touchend",this.handleTouchEnd,{passive:!0}),this.addEventListener("mousedown",this.handleMouseDownStart,{passive:!0}),this.addEventListener("mousemove",this.handleMouseMove,{passive:!0}),this.addEventListener("mouseup",this.handleMouseUp,{passive:!0})}calculateSwipeDirection(e,i){let s=null;return Math.abs(e)>=this._swipeThreshold&&Math.abs(i)<=this._swipeRestraint&&(s=e<0?"left-swipe":"right-swipe"),s}handleMouseDownStart(e){this._isMouseDown=!0,this._swipeCounter=0,this._swipeStartX=e.clientX,this._swipeStartY=e.clientY,this._swipeStartTime=performance.now(),this.style.cursor="grabbing"}handleMouseMove(){this._isMouseDown&&this._swipeCounter===0&&(this._swipeCounter=this._swipeCounter+1)}handleMouseUp(e){if(this._isMouseDown=!1,this._swipeCounter===1){const i=Math.abs(this._swipeStartX/e.clientX),s=100*(1-i),h=Math.abs(this._swipeStartY/e.clientY),n=100*(1-h);if(performance.now()-this._swipeStartTime<=this._allowedSwipeTime){const l=this.calculateSwipeDirection(s,n);if(l&&!this._isTransitioning){this._isTransitioning=!0,this._isTimerPaused||(this._isTimerPaused=!0);let c=1;l==="left-swipe"?c=1:c=-1;const o=this._currentSlideIndex;let d=this._currentSlideIndex+c;d<0?d=this._carouselSlides.length-1:d>this._carouselSlides.length-1&&(d=0),this._currentSlideIndex=d,this.transitionSlides(o,d,c)}}}this.style.cursor="grab",this._swipeCounter=0}}export{w as default};
